<style>
    a:hover, a:active {
        text-decoration: none;
        background-color: white;
        color: black;
        outline: none;
    }

    .label {
        font-size: 1em;
    }

    .col-sm-12 {
        height: 40px;
        line-height: 40px;
        border-bottom: 1px dashed #999;
    }
</style>
<% ppresenter = PackagePresenter.new(@package) %>

<div class="panel panel-default">
  <ol class="breadcrumb" style="background: transparent;padding: 20px 0 0 20px;font-size: 1.2em;">
    <li class="active">运输管理</li>
    <li class="active">发运流程</li>
    <li>
      <a href="/packages" title="返回包装箱">包装箱</a>
    </li>
    <li class="active">
      <span class="label label-primary"><%= @package.container_id %></span>
      <% if current_user.permission?(:operate_delivery) %>
          <%= link_to content_tag(:i, '', :class => 'glyphicon glyphicon-pencil'), edit_package_path, :style => 'color:steelblue;margin-left:10px;', :title => "编辑包装箱" %>
      <% end %>
    </li>
  </ol>
</div>

<div class="panel panel-primary">
  <div class="panel-heading">
    <div class="panel-title">
      基础信息
    </div>
  </div>

  <div class="panel-body">

    <div class="col-sm-12">
      <div class="col-sm-4">
        零件号:
        <%= PackageLabelRegex.part_prefix_string + @package.package.part.nr %>
      </div>
      <div class="col-sm-4">
        数量:
        <%= PackageLabelRegex.quantity_prefix_string + @package.package.quantity_str %>
      </div>
      <div class="col-sm-4">
        目的地:
        <%= @package.destination.name if @package.destination %>
      </div>
    </div>

    <div class="col-sm-12">
      <div class="col-sm-4">
        入库时间:
        <%= @package.package.fifo_time_display %>
      </div>
      <div class="col-sm-4">
        上架库位:
        <%= ppresenter.position_nr %>
      </div>
      <div class="col-sm-4">
        备注:
        <%= @package.remark %>
      </div>
    </div>

    <div class="col-sm-12">
      <div class="col-sm-4">
        状态:
        <%= @package.state_display %>
      </div>
      <div class="col-sm-4">
        所属托盘:
        <%= link_to content_tag(:span, @package.parent.container_id, :class => 'label label-primary'), forklift_path(@package.parent) if @package.parent %>
      </div>
      <div class="col-sm-4">
        所属运单:
        <%= link_to content_tag(:span, @package.parent.parent.container_id, :class => 'label label-primary'), delivery_path(@package.parent.parent) if @package.parent && @package.parent.parent %>
      </div>
    </div>

    <div class="col-sm-12" style="margin-left: 15px;border: none;">
      创建信息:
      <%= "#{@package.user.name} 在 #{ppresenter.created_at} 创建于 #{@package.destination.name} " %>
    </div>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <div class="panel-title">
      操作记录
    </div>
  </div>

  <div class="panel-body">
    <% @package.get_records.each do |r| %>
        <div class="col-sm-4">
          <%= r.display %>
        </div>
    <% end %>
  </div>
</div>