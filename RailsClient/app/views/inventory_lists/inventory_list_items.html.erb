<style>
    .digg_pagination .page_info {
        text-align: left;
        width: auto;
        margin-left: -20px;
        margin-right: -20px;
    }

    .digg_pagination {
        background: transparent;
    }

    .btn {
        margin: 0 0 10px 0;
        width: 200px;
    }

    .table > thead > tr > th, .table > tbody > tr > td {
        text-align: center;
    }

    a:hover, a:active {
        text-decoration: none;
        background-color: white;
        color: black;
        outline: none;
    }
</style>

<p id="notice"><%= notice %></p>

<div class="panel panel-default">
  <ol class="breadcrumb" style="background: transparent;padding: 20px 0 0 20px;font-size: 1.2em;">
    <li class="active">库存管理</li>
    <li class="active">材料盘点</li>
    <li>
      <a href="/inventory_lists" title="返回盘点单清单">盘点单清单</a>
    </li>
    <li class="active">
      盘点项列表
    </li>
  </ol>
</div>

<div class="col-sm-12">
  <form method="get" action="<%= send("search_inventory_list_items_path") %>">
    <div class="col-sm-3">
      零件号：
      <input type="text" name="inventory_list_item[part_id]" value="<%= @id %>"/>
      <input type="hidden" name="inventory_list_item[part_id_fuzzy]"/>
    </div>
    <div class="col-sm-3">
      <input type="submit" value="查 找" class="btn btn-primary"/>
    </div>
  </form>

  <div class="col-sm-3">
    <%= link_to "导出详细", export_list_detail_inventory_list_item_path(@inventory_list.id), class: "btn btn-default", data: {confirm: "数据量较大，确定导出?"} %>
  </div>
  <div class="col-sm-3">
    <%= link_to "导出汇总", export_list_total_inventory_list_item_path(@inventory_list.id), class: "btn btn-info", data: {confirm: "数据量较大，确定导出?"} %>
  </div>
</div>

<div class="col-sm-12">
  <div class="col-sm-4">
    <% if @inventory_list.has_unlocked_pack_item %>
        <%= link_to "锁定包装箱库存", lock_unlock_list_inventory_list_item_path(@inventory_list.id), class: "btn btn-warning", data: {confirm: "确定?"} %>
    <% end %>
  </div>
  <div class="col-sm-4">
    <% if @inventory_list.has_locked_pack_item %>
        <%= link_to "解锁包装箱库存", lock_unlock_list_inventory_list_item_path(@inventory_list.id), class: "btn btn-warning", data: {confirm: "确定?"} %>
    <% end %>
  </div>
  <div class="col-sm-4">
    <% if @inventory_list.state==InventoryListState::PROCESSING && @inventory_list.has_un_stored_item %>
        <%= link_to "开始入库", store_list_inventory_list_item_path(@inventory_list.id), class: "btn btn-warning", data: {confirm: "入库后将清空原有的库存记录以新的盘点结果作为库存记录"} %>
    <% end %>
  </div>
</div>

<div class="col-sm-12">
  <div class="digg_pagination">
    <div class="page_info">
      <%= page_entries_info @inventory_list_items %>
    </div>
    <%= will_paginate @inventory_list_items, :container => false %>
  </div>
</div>

<table class="table table-bordered table-striped">
  <thead>
  <tr>
    <th>NO.</th>
    <th>零件号</th>
    <th>FIFO</th>
    <th>FIFO报表</th>
    <th>数量</th>
    <th>原数量</th>
    <th>盘点库位号</th>
    <th>唯一码</th>
    <th>目前仓库</th>
    <th>目前库位</th>
    <!--<th>原材料/半成品/成品标记</th>-->
    <!--<th>原材料线/非线标记</th>-->
    <!--<th>需要转换</th>-->
    <!--<th>创建人</th>-->
    <th>是否在库存</th>
    <!--<th>是否已锁定包装箱库存</th>-->
    <th>是否已入库</th>
    <th>所属清单</th>
    <th>盘点状态</th>
    <th>备注</th>
    <th colspan="2">操作</th>
  </tr>
  </thead>

  <tbody>
  <% @inventory_list_items.each_with_index do |inventory_list_item, i| %>
      <tr>
        <td><%= i+1 %></td>
        <td><%= inventory_list_item.part.nr %></td>
        <td><%= inventory_list_item.fifo_display %></td>
        <td><%= inventory_list_item.fifo_export_display %></td>

        <td><%= inventory_list_item.qty %></td>
        <td><%= inventory_list_item.origin_qty %></td>
        <td><%= inventory_list_item.position_nr %></td>
        <td><%= inventory_list_item.package_id %></td>

        <td><%= inventory_list_item.current_whouse_object.nr if inventory_list_item.current_whouse_object %></td>
        <td><%= inventory_list_item.current_position_object.nr if inventory_list_item.current_position_object %></td>


        <!--<td><%= inventory_list_item.part_form_mark %></td>-->
        <!--<td><%= inventory_list_item.part_wire_mark %></td>-->
        <!--<td><%= inventory_list_item.need_convert_display %></td>-->
        <!--<td><%= inventory_list_item.user.blank? ? '' : inventory_list_item.user.nr %></td>-->
        <td><%= inventory_list_item.in_store_display %></td>
        <!--<td><%= inventory_list_item.locked_display %></td>-->
        <td><%= inventory_list_item.in_stored_display %></td>
        <td><%= inventory_list_item.inventory_list.name %></td>
        <td><%= InventoryListState.display inventory_list_item.inventory_list.state %></td>
        <td><%= inventory_list_item.remark %></td>

        <td>
          <%= link_to content_tag(:i, '', :class => 'glyphicon glyphicon-eye-open', :style => 'color:green;'), inventory_list_item, :title => '查看移库项详情' %>

          <% unless inventory_list_item.in_stored? %>
              <%= link_to content_tag(:i, '', :class => ' glyphicon glyphicon-trash', :style => 'color:darkred;'), inventory_list_item, method: :delete, data: {confirm: 'Are you sure?'}, :title => '删除移库项' %>
          <% end %>
        </td>
      </tr>
  <% end %>
  </tbody>
</table>

<div class="digg_pagination">
  <%= will_paginate @inventory_list_items, :container => false %>
</div>