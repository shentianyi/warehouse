<style>
    .btn {
        width: 200px;
        margin: 10px 0 10px 0;
    }

    .label {
        font-size: 1em;
    }

    .IconA {
        margin: 0 10px;
        font-size: 1.2em;
    }

    .IconA:hover {
        text-decoration: none;
        background-color: white;
    }

    .table > thead > tr > th, .table > tbody > tr > td {
        text-align: center;
    }
    
    a:hover, a:active {
        text-decoration: none;
        background-color: white;
        color: black;
        outline: none;
    }
</style>

<div class="panel panel-default">
  <ol class="breadcrumb" style="background: transparent;padding: 20px 0 0 20px;font-size: 1.2em;">
    <li class="active">库存管理</li>
    <li class="active">
      材料盘点
    </li>
    <li class="active">
      盘点单清单
    </li>
  </ol>
</div>

<div class="col-sm-12" style="margin-bottom: 20px;">
  <% if current_user.permission?(:operate_inventory_create) %>
      <div class="col-sm-4">
        <%= link_to "新建盘点", send("new_#{@model}_path"), :class => 'btn btn-default' %>
      </div>
  <% end %>
  <div class="col-sm-4">
    <%= link_to "导出 汇总", export_total_inventory_lists_path, class: "btn btn-default", data: {confirm: "数据量较大，确定导出?"} %>
  </div>
  <div class="col-sm-4">
    <%= link_to "导出 仓库 汇总", export_by_whouse_inventory_lists_path, class: "btn btn-info", data: {confirm: "数据量较大，确定导出?"}, :style => 'color:white;' %>
  </div>
</div>

<div class="col-sm-12" style="margin-bottom: 30px;">
  <div class="digg_pagination">
    <div class="page_info">
      <%= page_entries_info @inventory_lists %>
    </div>
    <%= will_paginate @inventory_lists, :container => false %>
  </div>
</div>

<table class="table table-bordered table-striped">
  <thead>
  <tr>
    <th>No.</th>
    <th>名称</th>
    <th>状态</th>
    <th>仓库</th>

    <th>清单</th>

    <th>创建人</th>
    <th>创建时间</th>

    <th>导入盘点</th>
    <th>盘点差异</th>
    <th colspan="3">操作</th>
  </tr>
  </thead>

  <tbody>
  <% @inventory_lists.each_with_index do |inventory_list, i| %>
      <tr>
        <td><%= i+1 %></td>
        <td><%= inventory_list.name %></td>
        <td><%= InventoryListState.display inventory_list.state %></td>
        <td><%= inventory_list.whouse.blank? ? '' : inventory_list.whouse.nr %></td>

        <td>
          <%= link_to content_tag(:span, '清单列表', :class => 'label label-primary'), inventory_list_items_inventory_list_path(inventory_list) %>
          <span class="badge"><%= inventory_list.inventory_list_items.count %></span>
        </td>

        <td><%= inventory_list.user.blank? ? '' : inventory_list.user.nr %></td>
        <td><%= inventory_list.created_at.localtime.strftime('%Y-%m-%d %H:%M:%S') %></td>

        <td>
          <%= link_to content_tag(:span, '导入盘点', :class => 'label label-primary'), import_inventory_list_items_path(id: inventory_list.id) %>
        </td>
        <td>
          <%= link_to content_tag(:span, '盘点差异', :class => 'label label-primary'), discrepancy_inventory_list_path(inventory_list) %>
        </td>

        <td>
          <%= link_to content_tag(:i, '', :class => 'glyphicon glyphicon-eye-open', :style => 'color:green;'), inventory_list, :class => 'IconA' %>
          <% unless SysConfigCache.inventory_enable_value=='true' && current_user.inventoryer? %>
              <%= link_to content_tag(:i, '', :class => 'glyphicon glyphicon-pencil', :style => 'color:#4F94CD;'), edit_inventory_list_path(inventory_list), :class => 'IconA' %>
              <%= link_to content_tag(:i, '', :class => ' glyphicon glyphicon-trash', :style => 'color:darkred;'), inventory_list, method: :delete, data: {confirm: 'Are you sure?'}, :class => 'IconA' %>
          <% end %>
        </td>
      </tr>
  <% end %>
  </tbody>
</table>

<br>
<div class="digg_pagination">
  <%= will_paginate @inventory_lists, :container => false %>
</div>
