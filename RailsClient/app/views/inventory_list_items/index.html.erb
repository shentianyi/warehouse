<style>
    .col-sm-12 {
        height: 40px;
        line-height: 40px;
    }

    .table > thead > tr > th, .table > tbody > tr > td {
        text-align: center;
    }
</style>

<div class="panel panel-default">
  <ol class="breadcrumb" style="background: transparent;padding: 20px 0 0 20px;font-size: 1.2em;">
    <li class="active">库存管理</li>
    <li class="active">
      材料盘点
    </li>
    <li class="active">
      盘点项列表
    </li>
  </ol>
</div>

<div class="all-search">
  <form method="get" action="<%= send("search_#{@model.pluralize}_path") %>">

    <div class="col-sm-12">
      <div class="col-sm-3">
        零件号：
        <input type="text" name="inventory_list_item[part_id]" value="<%= @part_id %>"/>
        <input type="hidden" name="inventory_list_item[part_id_fuzzy]"/>
      </div>
      <div class="col-sm-3">
        状态：
        <%= select 'inventory_list', 'state', InventoryListState.menu, selected: @inventory_list_state, include_blank: true %>
      </div>
      <div class="col-sm-3">
        仓库号：
        <%= select_tag('inventory_list_item[whouse_id]', options_from_collection_for_select(Whouse.all, :nr, :name, @whouse_id), include_blank: true) %>
      </div>
      <div class="col-sm-3">
        库位号：
        <input type="text" name="inventory_list_item[position]" value="<%= @position %>"/>
        <input type="hidden" name="inventory_list_item[position_fuzzy]"/>
      </div>
    </div>

    <div class="col-sm-12" style="margin-bottom: 10px;">
      <div class="col-sm-4">
        是否入库(0-否，1-是)：
        <input type="text" name="inventory_list_item[in_stored]" value="<%= @in_stored %>"/>
      </div>
      <div class="col-sm-4">
        <input type="submit" style="width: 200px;" value="查找" class="btn btn-primary" name="search"/>
      </div>
      <div class="col-sm-4">
        <%= link_to "新建盘点项", send("new_#{@model}_path"), :class => 'btn btn-primary', :style => 'width:200px;color:white;' %>
      </div>
    </div>
  </form>
</div>

<div class="col-sm-12" style="margin-bottom: 20px">
  <div class="digg_pagination">
    <div class="page_info">
      <%= page_entries_info @inventory_list_items %>
    </div>
    <%= will_paginate @inventory_list_items, :container => false %>
  </div>
</div>

<table class="table table-bordered table-striped">
  <thead>
  <tr>
    <th>NO.</th>
    <th>零件号</th>
    <th>FIFO</th>
    <th>FIFO报表</th>
    <th>数量</th>
    <th>原数量</th>
    <th>盘点库位号</th>
    <th>唯一码</th>
    <th>目前仓库</th>
    <th>目前库位</th>
    <th>原材料/半成品/成品标记</th>
    <th>原材料线/非线标记</th>
    <th>需要转换</th>
    <th>创建人</th>
    <th>是否在库存</th>
    <th>是否已锁定包装箱库存</th>
    <th>是否已入库</th>
    <th>所属清单</th>
    <th>盘点状态</th>
    <th>备注</th>
    <th colspan="2">操作</th>
  </tr>
  </thead>

  <tbody>
  <% @inventory_list_items.each_with_index do |inventory_list_item, i| %>
      <tr>
        <td><%= i+1 %></td>
        <% unless inventory_list_item.in_stored? %>
            <td><%= best_in_place inventory_list_item, :part_id, as: :input %></td>
            <td><%= best_in_place inventory_list_item, :fifo_display, as: :input, display_as: :fifo_display %></td>
        <% else %>
            <td><%= inventory_list_item.part_id %></td>
            <td><%= inventory_list_item.fifo_display %></td>
        <% end %>
        <td><%= inventory_list_item.fifo_export_display %></td>
        <% unless inventory_list_item.in_stored? %>
            <td><%= best_in_place inventory_list_item, :qty, as: :input %></td>
            <td><%= best_in_place inventory_list_item, :origin_qty, as: :input %></td>
            <td><%= best_in_place inventory_list_item, :position, as: :input %></td>
        <% else %>
            <td><%= inventory_list_item.qty %></td>
            <td><%= inventory_list_item.origin_qty %></td>
            <td><%= inventory_list_item.position %></td>
        <% end %>
        <td><%= inventory_list_item.package_id %></td>
        <td><%= inventory_list_item.current_whouse %></td>
        <td><%= inventory_list_item.current_position %></td>
        <% unless inventory_list_item.in_stored? %>
            <td><%= best_in_place inventory_list_item, :part_form_mark, as: :input %></td>
            <td><%= best_in_place inventory_list_item, :part_wire_mark, as: :input %></td>
        <% else %>
            <td><%= inventory_list_item.part_form_mark %></td>
            <td><%= inventory_list_item.part_wire_mark %></td>
        <% end %>
        <td><%= inventory_list_item.need_convert_display %></td>
        <td><%= inventory_list_item.user_id %></td>
        <td><%= inventory_list_item.in_store_display %></td>
        <td><%= inventory_list_item.locked_display %></td>
        <td><%= inventory_list_item.in_stored_display %></td>
        <td><%= inventory_list_item.inventory_list.name %></td>
        <td><%= InventoryListState.display inventory_list_item.inventory_list.state %></td>
        <td><%= inventory_list_item.remark %></td>

        <td>
          <%= link_to content_tag(:i, '', :class => 'glyphicon glyphicon-eye-open', :style => 'color:green;'), inventory_list_item, :title => '查看移库项详情' %>

          <% unless inventory_list_item.in_stored? %>
              <%= link_to content_tag(:i, '', :class => ' glyphicon glyphicon-trash', :style => 'color:darkred;'), inventory_list_item, method: :delete, data: {confirm: 'Are you sure?'}, :title => '删除移库项' %>
          <% end %>
        </td>
      </tr>
  <% end %>
  </tbody>
</table>

<div class="digg_pagination">
  <%= will_paginate @inventory_list_items, :container => false %>
</div>
